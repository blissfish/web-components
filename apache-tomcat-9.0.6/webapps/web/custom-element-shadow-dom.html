<html>
<head>
<script src="webcomponents-bundle.js"></script>
<link rel="stylesheet" type="text/css" href="style.css">
<title>Web Components</title>
</head>
<body>
<a href="/web">Home</a>

	<script>
		// hide body to prevent FOUC
		document.body.style.opacity = 0;
		window.addEventListener('WebComponentsReady', function() {
			// show body now that everything is ready
			document.body.style.opacity = 1;
		});
	</script>
	<script>
		class MyCustomElementShadowDom extends HTMLElement {
			constructor() {
				super();
				this.toogle = 0;
				this.url = `http://localhost:8080/web/content.html`;
<<<<<<< HEAD
				this.content = `<h1>MyCustomElementShadowDom</h1><div id="my-div">				
				<p>placeholder ...</p>						
				</div><button type="button">Load</button>`;
=======
				this.content = `<p id="content">placeholder ...</p>`;
				this.container = `<div id="my-div" >
					<h1>MyCustomElementShadowDom</h1>
					`+this.content+`
					<button type="button">Load</button>		
					</div>`;
>>>>>>> branch 'master' of https://github.com/blissfish/web-components.git
			}
			// Called when your element is inserted in the DOM or
			// immediately after the constructor if it’s already in the DOM
			connectedCallback() {
				console.log('Custom element added to page.');
			    let shadowRoot = this.attachShadow({mode: 'open'});
<<<<<<< HEAD
			    shadowRoot.innerHTML = this.content;
				this.addEventListener('click', e => {
=======
			    shadowRoot.innerHTML = this.container;
				this.addEventListener('click', e => {						
>>>>>>> branch 'master' of https://github.com/blissfish/web-components.git
					if (this.toogle == 0) {
						this.toogle = 1;
						this.load(shadowRoot);
					} else {
						console.log('Custom elements restores original ' + this.container);	
						this.toogle = 0;
						shadowRoot.innerHTML = this.container;
					}
				});
			}
			load(shadowRoot) {
				console.log('Custom elements loads content from ' + this.url);	
				var xhttp = new XMLHttpRequest();
				xhttp.onreadystatechange = function() {
					if (this.readyState == 4 && this.status == 200) {
<<<<<<< HEAD
						let child = shadowRoot.getElementById("my-div");
						child.innerHTML = this.responseText;
=======
						let child = shadowRoot.getElementById("content");
						  var myDiv = document.createElement("div");
						  myDiv.innerHTML = this.responseText; 
						child.replaceWith(myDiv);

		
>>>>>>> branch 'master' of https://github.com/blissfish/web-components.git
					}
				};
				xhttp.open("GET", this.url, true);
				xhttp.send();
			}
		}
		window.customElements.define('my-custom-element-shadow-dom', MyCustomElementShadowDom);
	</script>
	<my-custom-element-shadow-dom></my-custom-element-shadow-dom>	
</body>
</html>