<!-- Defines element markup -->
<template id="my-template">
<style>
p {
	color: darkred;
	font-size: 16px;	
}

h2 {
	color: darkgrey;
	font-size: 28px;	
}

div {
	border: 1px;
	border-style: solid;
	padding: 16px;
	margin: 10px;
	font-family: Arial, sans-serif;		
}

.rcorners {
	border-radius: 25px;
	background: aliceblue;	
	box-shadow: 4px 4px 6px #000000;
	padding: 16px;
	margin: 10px;		
}
</style>
    <div id="container" class="rcorners"><h2>A Simple Custom Element</h2><p>click me ... <strong></strong></p></div>
</template>

<script>
(function(window, document, undefined) {
    this.toogle == 0;

    var thisDoc =  (document._currentScript || document.currentScript).ownerDocument;
    var template = thisDoc.querySelector('#my-template').content;
    var MyElementProto = Object.create(HTMLElement.prototype);
    MyElementProto.who = 'Default';
    MyElementProto.createdCallback = function() {
        var shadowRoot = this.createShadowRoot();
        var clone = document.importNode(template, true);
        shadowRoot.appendChild(clone);
        this.strong = shadowRoot.querySelector('strong');
        if (this.hasAttribute('who')) {
            var who = this.getAttribute('who');
            this.setWho(who);
        }
        else {
            this.setWho(this.who);
        }
        this.addEventListener('click', e => {
			console.log('Custom element clicked.');
			if(this.toogle == 0) {
				load(shadowRoot);
				this.toogle = 1;
			} else{
				this.toogle = 0;
				console.log('Custom element restoring orig content ...');
		 		alert("hi");
		        shadowRoot.appendChild(clone);				
			}					
		});
    };
  
   function load(shadowRoot) {
		console.log('Custom element loading content ...');
		alert("hi");
		var xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				let child = shadowRoot.getElementById("container");
				let newChild = document.createElement("div");
				newChild.setAttribute("id", "container");
				newChild.setAttribute("class", "rcorners");
				newChild.innerHTML = this.responseText; 
				child.replaceWith(newChild);
			}
		};
		xhttp.open("GET", "content.html", true);
		xhttp.send();

   };
	
    MyElementProto.attributeChangedCallback = function(attr, oldVal, newVal) {
        if (attr === 'who') {
            this.setWho(newVal);
        }
    };

    MyElementProto.setWho = function(val) {
        this.who = val;
        this.strong.textContent = this.who;
    };

    window.MyElement = document.registerElement('custom-element', {
        prototype: MyElementProto
    });
})(window, document);
</script>
